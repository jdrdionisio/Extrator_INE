"0","#Falta codigo de debugging"
"0",""
"0","for (k in 1:a) {"
"0","  #COMECA POR LER O INDICADOR A RETIRAR"
"0","  indicador_atual <- indicador[k]"
"0","  counter <- sleep(counter)"
"0","  #TESTA A DESAGREGAGACAO DE 2014"
"0","  result <- fromJSON(paste0(""https://www.ine.pt/ine/json_indicador/pindica.jsp?op=2&varcd="",indicador_atual,""&Dim1=T"", desag, cod_2014[79], ""&lang=PT""))"
"0","  result <- as.data.frame(result)"
"0","  #OS DADOS DO INE VEM COM MI E DADOS - PARA A EXTRACAO"
"0","  if ((""IndicadorCod"" %in% colnames(result))){ "
"0","  for (w in 1:b) {"
"0","  #retirar indicador com desagregação municipio 2014"
"0","  counter <- sleep(counter)"
"0","  result <- fromJSON(paste0(""https://www.ine.pt/ine/json_indicador/pindica.jsp?op=2&varcd="",indicador_atual,""&Dim1=T"", desag, cod_2014[w], ""&lang=PT""))"
"0","  agreg <- ""NUTSIII"""
"0","  dados <- as.data.frame(result$Dados)"
"0","  colunas_nanos <- colnames(dados)"
"0","    num_colunas <- length(colunas_nanos)"
"0","    if(obs_back > num_colunas){"
"0","        x <- num_colunas"
"0","    }else{"
"0","      x <-  obs_back"
"0","    }"
"0","    obs_backs <- as.character(c(colunas_nanos[(num_colunas-x):(num_colunas)]))"
"0","    for (i in 1:x) {"
"0","    #ver e retirar os nomes das colunas de cada ano para o select"
"0","    obs_backs2 <-  obs_backs[-i]"
"0","    dados1 <- dados %>%"
"0","        unnest(obs_backs[i])%>%"
"0","        select(-all_of(obs_backs2))"
"0","    result_list[[obs_backs[i]]] <- bind_rows(result_list[[obs_backs[i]]], dados1)"
"0","  Sys.sleep(1)"
"0","    }}"
"0","    if (w %% 100 == 0) {"
"0","      print(cod_2014[w])"
"0","   }"
"0","    }"
"0","  else if(length(result_list)==0){"
"0","  counter <- sleep(counter)"
"0","  #TESTA A DESAGREGAGACAO DE 2002"
"0","  result <- fromJSON(paste0(""https://www.ine.pt/ine/json_indicador/pindica.jsp?op=2&varcd="",indicador_atual,""&Dim1=T"",desag, cod_2002[1], ""&lang=PT""))"
"0","  result <- as.data.frame(result)"
"0","  if ((""IndicadorCod"" %in% colnames(result))) {"
"0","  #retirar indicador com desagregação municipio 2002"
"0","  for (e in 1:b) {"
"0","  counter <- sleep(counter)"
"0","  result <- fromJSON(paste0(""https://www.ine.pt/ine/json_indicador/pindica.jsp?op=2&varcd="",indicador_atual,""&Dim1=T"",desag, cod_2002[e], ""&lang=PT""))"
"0","  agreg <- ""NUTSIII"""
"0","  dados <- as.data.frame(result$Dados)"
"0","  colunas_nanos <- colnames(dados)"
"0","    num_colunas <- length(colunas_nanos)"
"0","    if(obs_back > num_colunas){"
"0","        x <- num_colunas"
"0","    }else{"
"0","      x <-  obs_back"
"0","    }"
"0","    obs_backs <- as.character(c(colunas_nanos[(num_colunas-x):(num_colunas)]))"
"0","    for (i in 1:x) {"
"0","    #ver e retirar os nomes das colunas de cada ano para o select"
"0","    obs_backs2 <-  obs_backs[-i]"
"0","    dados1 <- dados %>%"
"0","        unnest(obs_backs[i])%>%"
"0","        select(-all_of(obs_backs2))"
"0","    result_list[[obs_backs[i]]] <- bind_rows(result_list[[obs_backs[i]]], dados1)"
"0","  Sys.sleep(1)"
"0","    }}"
"0","    if (e %% 100 == 0) {"
"0","      print(cod_2014[e])"
"0","   }"
"0","  }"
"0","  }"
"0","  else if(length(result_list)==0){"
"0","  counter <- sleep(counter)"
"0","  #TESTA A DESAGREGAGACAO DE NUTSII"
"0","  result <- fromJSON(paste0(""https://www.ine.pt/ine/json_indicador/pindica.jsp?op=2&varcd="",indicador_atual,""&Dim1=T"",desag, nuts_ii_cod[1], ""&lang=PT""))"
"0","  result <- as.data.frame(result)"
"0","  if ((""IndicadorCod"" %in% colnames(result))) {"
"0","  #retirar indicador com desagregação NUTSII"
"0","  for (r in 1:c) {"
"0","  counter <- sleep(counter)"
"0","  result <- fromJSON(paste0(""https://www.ine.pt/ine/json_indicador/pindica.jsp?op=2&varcd="",indicador_atual ,""&Dim1=T"",desag, nuts_ii_cod[r], ""&lang=PT""))"
"0","  agreg <- ""NUTSII"""
"0","  dados <- as.data.frame(result$Dados)"
"0","  colunas_nanos <- colnames(dados)"
"0","    num_colunas <- length(colunas_nanos)"
"0","    if(obs_back > num_colunas){"
"0","        x <- num_colunas"
"0","    }else{"
"0","      x <-  obs_back"
"0","    }"
"0","    obs_backs <- as.character(c(colunas_nanos[(num_colunas-x):(num_colunas)]))"
"0","    for (i in 1:x) {"
"0","    #ver e retirar os nomes das colunas de cada ano para o select"
"0","    obs_backs2 <-  obs_backs[-i]"
"0","    dados1 <- dados %>%"
"0","        unnest(obs_backs[i])%>%"
"0","        select(-any_of(obs_backs2))"
"0","    result_list[[obs_backs[i]]] <- bind_rows(result_list[[obs_backs[i]]], dados1)"
"0","  Sys.sleep(1)"
"0","    }}"
"0","  }"
"0","  }"
"0","  else{"
"0","  counter <- sleep(counter)"
"0","  #TESTA A DESAGREGAGACAO NACIONAL OU FORA DO PADRAO"
"0","  result <- fromJSON(paste0(""https://www.ine.pt/ine/json_indicador/pindica.jsp?op=2&varcd="",indicador_atual,""&Dim1=T&lang=PT""))"
"0","  if ((""IndicadorCod"" %in% colnames(result))) {"
"0","  #retirar indicador sem desagragação"
"0","  agreg <- ""nacional"""
"0","  result <- as.data.frame(result)"
"0","   dados <- as.data.frame(result$Dados)"
"0","  colunas_nanos <- colnames(dados)"
"0","    num_colunas <- length(colunas_nanos)"
"0","    if(obs_back > num_colunas){"
"0","        x <- num_colunas"
"0","    }else{"
"0","      x <-  obs_back"
"0","    }"
"0","    obs_backs <- as.character(c(colunas_nanos[(num_colunas-x):(num_colunas)]))"
"0","    for (i in 1:x) {"
"0","    #ver e retirar os nomes das colunas de cada ano para o select"
"0","    obs_backs2 <-  obs_backs[-i]"
"0","    dados1 <- dados %>%"
"0","        unnest(obs_backs[i])%>%"
"0","        select(-all_of(obs_backs2))"
"0","    result_list[[obs_backs[i]]] <- bind_rows(result_list[[obs_backs[i]]], dados1)"
"0","  Sys.sleep(1)"
"0","    }}"
"0","  }"
"0","  if (length(result_list)!=0){"
"0","     x <- length(result_list)"
"0","    for (i in 1:x) {"
"0","      nomedf <- paste0(indicador_atual,""_"",obs_backs[i],""_"",agreg)"
"0","      assign(paste0(""full_df""), as.data.frame(result_list[[obs_backs[i]]])%>% "
"0","      select(-any_of(colunas_nanos))%>%left_join(linkage_geo, by=""geocod""))"
"0","      fwrite(full_df, file = paste0(""outputs/"",nomedf,"".csv""), bom = T)"
"0","  }"
"0","  }"
"0","  if (k == k) {"
"0","    print(indicador_atual)"
"0","    result_list <- list()"
"0","   }"
"0","}"
"1","[1]"
"1"," ""0008614"""
"1","
"
"1","[1]"
"1"," ""0009817"""
"1","
"
